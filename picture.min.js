/*! Picture v2.5.1 - Picture element polyfill for responsive images. Authors & copyright (c) 2013: WebLinc, David Knight. Forked & modified by Ivan NikoliÄ‡ */
"HTMLPictureElement"in window||function(a){"use strict";var b=a.document,c="",d=(a.addEventListener||(c="on")&&a.attachEvent,a.removeEventListener||a.detachEvent,/[^\s]+/g),e=function(a,b){var c=[];for(a=a.previousSibling;null!==a;)(!b||b(a))&&c.push(a),a=a.previousSibling;return c},f=function(a,b){var c=[];for(a=a.nextSibling;null!==a;)(!b||b(a))&&c.push(a),a=a.nextSibling;return c},g=function(a){var b=0;for(var c in a)a.hasOwnProperty(c)&&b++;return b},h=function(a){switch(a.nodeName.toUpperCase()){case"SPAN":return!0;default:return!1}},i=function(a){switch(a.nodeName.toUpperCase()){case"IMG":return!0;default:return!1}},j=function(a){for(var b=0,c=a.length;c>b;b++)null!==a[b].className.match(/postpone-placeholder/gi)&&(a[b].className+=" hidden ",a[b].style.display="none")},k=function(a,b,c){a.src=b.pictureCurrentSrc=c.src,c.element.appendChild(a),c.element.className+=" picture-source-loaded ",null===b.className.match(/picture-parsed/gi)&&(b.className+=" picture-parsed ")},l=function(a){for(var b=0,c=a.length;c>b;b++)if(null!==a[b].className.match(/picture-source-loaded/gi))return!0;return!1},m=function(a,c){var d=a.pictureImage,g=f(a,i),m=e(c.element,h),n=c.element.attributes;if(l(m)!==!0){for(var o in n)"object"==typeof n[o]&&null!==n[o].name.match(/data-src\d+/gi)&&a.setAttribute("data-current-src",n[o].name.replace("data-",""));if(null===a.parentNode)c.mql.removeListener(c.listener),c=a=null;else if(d||(d=a.pictureImage=b.createElement("img"),d.alt=a.pictureAlt,d.className+=" "+a.pictureClassList+" "),c&&c.src!==a.pictureCurrentSrc)if(0===g.length)k(d,a,c);else{var p=new Image;p.onload=function(){k(d,a,c),j(g)},p.src=a.pictureCurrentSrc=c.src}}},n=function(a){for(var c,d=a||b.getElementsByTagName("span"),e=0;"undefined"!=typeof(c=d[e]);e++)if("pictureSource"in c)for(var f,g=c.pictureSource.length-1;"undefined"!=typeof(f=c.pictureSource[g]);g--)f.listener||(f.listener=o(c,f),f.mql.addListener(f.listener))},o=function(a,b){return function(c){var d=a.pictureSource,e=b;c.matches||(e=d[d.join("").lastIndexOf("1")]),e&&m(a,e)}},p=function(a,b,c,d){return{element:a,src:b,mql:c,listener:d,toString:function(){return this.mql.matches?1:0}}},q=function(b,c,e,f){for(var g,h=e.indexOf(",")>=0&&e.split(",")||[e],i=null,j=0;"undefined"!=typeof(g=h[j]);j++){var k=f||"all",l=g.match(d),m=l[0],n=parseFloat(l[1],10),o=null;n>1&&(k=["(-webkit-min-device-pixel-ratio: "+n+")","(min-resolution: "+n+"dppx)","(min-resolution: "+96*n+"dpi)","not all"].join(" and "+k+", ")),k&&(o=p(c,m,a.matchMedia(k),null),o.mql.matches&&(i=o),b.pictureSource.push(o))}return i};a.Picture={parse:function(c){for(var d,e=c||b.getElementsByTagName("span"),f=0;"undefined"!=typeof(d=e[f]);f++)if(null!==d.getAttribute("data-picture")&&!("pictureSource"in d)){var g=d.getElementsByTagName("span"),h=d.getAttribute("data-srcset"),i="",j=d.getElementsByTagName("img")[0],k=null,l=null,o=null;if(d.pictureSource=[],d.pictureImage=j&&"NOSCRIPT"!==j.parentNode.nodeName&&j,d.pictureAlt=d.getAttribute("data-alt")||j&&j.getAttribute("alt")||"picture",d.pictureClassList=d.getAttribute("data-class")||"",d.pictureCurrentSrc="",h?(l=q(d,d,h,""),l&&(o=l)):(i=d.getAttribute("data-src"),i&&(o=k=p(d,i,null,null))),!h&&!i)for(var r,s=g.length-1;"undefined"!=typeof(r=g[s]);s--){var t=r.getAttribute("data-media")||"(min-width:0px)";h=r.getAttribute("data-srcset"),i="",h?(l=q(d,r,h,t),l&&(o=l)):t&&(i=r.getAttribute("data-src"),i&&(k=p(r,i,a.matchMedia(t),null),k.mql.matches&&(o=k),d.pictureSource.push(k)))}o&&m(d,o)}n(e)},updatePicture:function(a,b){var c,d=a.pictureImage,e=a.getElementsByTagName("span"),f=function(a){for(var b=0,c=a.length;c>b;b++)if(null!==a[b].className.match(/picture-source-loaded/gi))return a[b];return null},h=b["src-list"],i=g(h);for(var j in h)h.hasOwnProperty(j)&&(null!==f(e).getAttribute("data-"+j)&&(c=h[j]),i--,a.pictureSource[i].src=h[j].src,a.pictureSource[i].element.setAttribute("data-src",h[j].src));a.pictureAlt=b.alt,a.setAttribute("data-alt",b.alt),d.setAttribute("alt",b.alt),a.pictureCurrentSrc=c.src,d.setAttribute("src",c.src)}}}(window);